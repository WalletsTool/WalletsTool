# 数据库热重载功能使用说明

## 功能概述

为了解决用户每次修改代币配置后需要重启程序的问题，我们新增了数据库热重载功能。现在您可以在不重启程序的情况下应用数据库结构变更和数据更新。

## 功能位置

在**批量转账**页面的核心操作区，您会看到一个**数据库管理**按钮。该按钮会根据数据库状态显示不同的图标：
- ✅ 绿色勾号：数据库结构正常
- ⚠️ 黄色警告：数据库需要迁移

## 主要功能

### 1. 检查状态
点击**数据库管理** → **🔍 检查状态**
- 检查数据库表结构是否完整
- 验证必要的列（如 `contract_type`、`abi`）是否存在
- 显示是否需要执行迁移

### 2. 执行迁移/重载数据库
点击**数据库管理** → **🔄 执行迁移** 或 **🔄 重载数据库**
- 自动执行所有待处理的数据库迁移
- 添加缺失的表列
- 更新数据库结构到最新版本
- 无需重启程序

### 3. 刷新页面
点击**数据库管理** → **🔃 刷新页面**
- 重新加载链列表和代币列表
- 刷新页面显示的数据
- 确保界面显示最新的配置信息

## 使用场景

### 场景1：添加新的代币字段
当您手动修改数据库文件或添加新的代币字段时：
1. 点击**检查状态**查看数据库状态
2. 如果显示需要迁移，点击**执行迁移**
3. 迁移完成后点击**刷新页面**更新界面

### 场景2：修改代币配置
当您通过界面添加或修改代币配置后：
1. 点击**刷新页面**确保显示最新数据
2. 如有必要，可以点击**检查状态**验证数据库完整性

### 场景3：数据库结构更新
当程序更新包含新的数据库结构时：
1. 启动程序后会自动检查数据库状态
2. 如果按钮显示警告图标，点击**执行迁移**
3. 迁移完成后所有功能恢复正常

## 技术说明

### 自动检测
- 程序启动时会自动检查数据库状态
- 按钮图标会实时反映数据库状态
- 支持检测多种数据库结构问题

### 安全性
- 所有迁移操作都是安全的，不会丢失现有数据
- 使用 `ALTER TABLE` 语句添加新列
- 支持重复执行，不会产生错误

### 兼容性
- 兼容现有的所有数据库文件
- 支持从旧版本数据库升级到新版本
- 保持向后兼容性

## 注意事项

1. **备份重要数据**：虽然迁移过程是安全的，但建议在重要操作前备份数据库文件
2. **网络连接**：某些操作可能需要网络连接来验证配置
3. **权限要求**：确保程序有足够的权限修改数据库文件
4. **并发操作**：避免在迁移过程中进行其他数据库操作

## 故障排除

### 迁移失败
如果迁移失败，请检查：
- 数据库文件是否被其他程序占用
- 磁盘空间是否充足
- 程序是否有写入权限

### 状态检查失败
如果状态检查失败，请尝试：
- 重启程序
- 检查数据库文件完整性
- 查看控制台错误信息

### 界面未更新
如果界面显示的数据未更新，请：
- 点击**刷新页面**
- 重新选择链或代币
- 检查网络连接

## 联系支持

如果您在使用过程中遇到问题，请：
1. 查看控制台错误信息
2. 记录操作步骤和错误现象
3. 联系技术支持团队

---

通过这个热重载功能，您可以更高效地管理代币配置，无需频繁重启程序，大大提升了使用体验。